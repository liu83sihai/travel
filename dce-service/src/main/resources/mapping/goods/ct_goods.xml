<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dce.business.dao.goods.ICTGoodsDao">
	<resultMap id="BaseResultMap" type="com.dce.business.entity.goods.CTGoodsDo">
		<id column="goodsId" property="goodsId" />
		<result column="goodsSn" property="goodsSn" />
		<result column="title" property="title" />
		<result column="goodsImg" property="goodsImg" />
		<result column="goodsThums" property="goodsThums" />
		<result column="brandId" property="brandId" />
		<result column="shopId" property="shopId" />
		<result column="marketPrice" property="marketPrice" />
		<result column="shopPrice" property="shopPrice" />
		<result column="goodsStock" property="goodsStock" />
		<result column="saleCount" property="saleCount" />
		<result column="isBook" property="isBook" />
		<result column="bookQuantity" property="bookQuantity" />
		<result column="warnStock" property="warnStock" />
		<result column="goodsUnit" property="goodsUnit" />
		<result column="goodsSpec" property="goodsSpec" />
		<result column="isSale" property="isSale" />
		<result column="isBest" property="isBest" />
		<result column="isHot" property="isHot" />
		<result column="isRecomm" property="isRecomm" />
		<result column="isNew" property="isNew" />
		<result column="isAdminBest" property="isAdminBest" />
		<result column="isAdminRecom" property="isAdminRecom" />
		<result column="recommDesc" property="recommDesc" />
		<result column="cid1" property="cid1" />
		<result column="cid2" property="cid2" />
		<result column="cid3" property="cid3" />
		<result column="shopCatId1" property="shopCatId1" />
		<result column="shopCatId2" property="shopCatId2" />
		<result column="goodsDesc" property="goodsDesc" />
		<result column="isShopRecomm" property="isShopRecomm" />
		<result column="isIndexRecomm" property="isIndexRecomm" />
		<result column="isActivityRecomm" property="isActivityRecomm" />
		<result column="isInnerRecomm" property="isInnerRecomm" />
		<result column="status" property="status" />
		<result column="saleTime" property="saleTime" />
		<result column="attrCatId" property="attrCatId" />
		<result column="goodsKeywords" property="goodsKeywords" />
		<result column="goodsFlag" property="goodsFlag" />
		<result column="statusRemarks" property="statusRemarks" />
		<result column="createTime" property="createTime" />

	</resultMap>
	<select id="selectByPrimaryKey" parameterType="java.lang.Long"
		resultMap="BaseResultMap">
		select * from ct_goods where goodsId=#{goodsId}
	</select>

	<delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
		delete from
		ct_goods where goodsId = #{id,jdbcType=INTEGER}
	</delete>
	<insert id="insert" keyColumn="goodsId" keyProperty="goodsId"
		parameterType="com.dce.business.entity.goods.CTGoodsDo"
		useGeneratedKeys="true">
		insert into ct_goods (goodsSn,
		title,
		goodsImg,
		goodsThums,
		brandId,
		shopId,
		marketPrice,
		shopPrice,
		goodsStock,
		saleCount,
		isBook,
		bookQuantity,
		warnStock,
		goodsUnit,
		goodsSpec,
		isSale,
		isBest,
		isHot,
		isRecomm,
		isNew,
		isAdminBest,
		isAdminRecom,
		recommDesc,
		cid1,
		cid2,
		cid3,
		shopCatId1,
		shopCatId2,
		goodsDesc,
		isShopRecomm,
		isIndexRecomm,
		isActivityRecomm,
		isInnerRecomm,
		status,
		saleTime,
		attrCatId,
		goodsKeywords,
		goodsFlag,
		statusRemarks
		)
		values (
		#{goodsSn},
		#{title},
		#{goodsImg},
		#{goodsThums},
		#{brandId},
		#{shopId},
		#{marketPrice},
		#{shopPrice},
		#{goodsStock},
		#{saleCount},
		#{isBook},
		#{bookQuantity},
		#{warnStock},
		#{goodsUnit},
		#{goodsSpec},
		#{isSale},
		#{isBest},
		#{isHot},
		#{isRecomm},
		#{isNew},
		#{isAdminBest},
		#{isAdminRecom},
		#{recommDesc},
		#{cid1},
		#{cid2},
		#{cid3},
		#{shopCatId1},
		#{shopCatId2},
		#{goodsDesc},
		#{isShopRecomm},
		#{isIndexRecomm},
		#{isActivityRecomm},
		#{isInnerRecomm},
		#{status},
		#{saleTime},
		#{attrCatId},
		#{goodsKeywords},
		#{goodsFlag},
		#{statusRemarks}
		)
	</insert>

	<!-- 自定义 -->
	<insert id="insertSelective" parameterType="com.dce.business.entity.goods.CTGoodsDo">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Thu Aug 09 
			15:04:19 CST 2018. -->
		insert into ct_goods
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="goodsId != null">
				goodsId,
			</if>
			<if test="goodsSn != null">
				goodsSn,
			</if>
			<if test="title != null">
				title,
			</if>
			<if test="goodsImg != null">
				goodsImg,
			</if>
			<if test="goodsThums != null">
				goodsThums,
			</if>
			<if test="brandId != null">
				brandId,
			</if>
			<if test="shopId != null">
				shopId,
			</if>
			<if test="marketPrice != null">
				marketPrice,
			</if>
			<if test="shopPrice != null">
				shopPrice,
			</if>
			<if test="goodsStock != null">
				goodsStock,
			</if>
			<if test="saleCount != null">
				saleCount,
			</if>
			<if test="isBook != null">
				isBook,
			</if>
			<if test="bookQuantity != null">
				bookQuantity,
			</if>
			<if test="warnStock != null">
				warnStock,
			</if>
			<if test="goodsUnit != null">
				goodsUnit,
			</if>
			<if test="isSale != null">
				isSale,
			</if>
			<if test="isBest != null">
				isBest,
			</if>
			<if test="isHot != null">
				isHot,
			</if>
			<if test="isRecomm != null">
				isRecomm,
			</if>
			<if test="isNew != null">
				isNew,
			</if>
			<if test="isAdminBest != null">
				isAdminBest,
			</if>
			<if test="isAdminRecom != null">
				isAdminRecom,
			</if>
			<if test="recommDesc != null">
				recommDesc,
			</if>
			<if test="cid1 != null">
				cid1,
			</if>
			<if test="cid2 != null">
				cid2,
			</if>
			<if test="cid3 != null">
				cid3,
			</if>
			<if test="shopCatId1 != null">
				shopCatId1,
			</if>
			<if test="shopCatId2 != null">
				shopCatId2,
			</if>
			<if test="goodsDesc != null">
				goodsDesc,
			</if>
			<if test="isShopRecomm != null">
				isShopRecomm,
			</if>
			<if test="isIndexRecomm != null">
				isIndexRecomm,
			</if>
			<if test="isActivityRecomm != null">
				isActivityRecomm,
			</if>
			<if test="isInnerRecomm != null">
				isInnerRecomm,
			</if>
			<if test="status != null">
				status,
			</if>
			<if test="saleTime != null">
				saleTime,
			</if>
			<if test="attrCatId != null">
				attrCatId,
			</if>
			<if test="goodsKeywords != null">
				goodsKeywords,
			</if>
			<if test="goodsFlag != null">
				goodsFlag,
			</if>
			<if test="statusRemarks != null">
				statusRemarks,
			</if>
			<if test="createTime != null">
				createTime,
			</if>

		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="goodsId != null">
				#{goodsId,jdbcType=INTEGER},
			</if>
			<if test="goodsSn != null">
				#{goodsSn,jdbcType=VARCHAR},
			</if>
			<if test="title != null">
				#{title,jdbcType=VARCHAR},
			</if>
			<if test="goodsImg != null">
				#{goodsImg,jdbcType=VARCHAR},
			</if>
			<if test="goodsThums != null">
				#{goodsThums,jdbcType=INTEGER},
			</if>
			<if test="brandId != null">
				#{brandId,jdbcType=INTEGER},
			</if>
			<if test="shopId != null">
				#{shopId,jdbcType=INTEGER},
			</if>
			<if test="marketPrice != null">
				#{marketPrice,jdbcType=DECIMAL},
			</if>
			<if test="shopPrice != null">
				#{shopPrice,jdbcType=DECIMAL},
			</if>
			<if test="goodsStock != null">
				#{goodsStock,jdbcType=INTEGER},
			</if>
			<if test="saleCount != null">
				#{saleCount,jdbcType=INTEGER},
			</if>
			<if test="isBook != null">
				#{isBook,jdbcType=TINYINT},
			</if>
			<if test="bookQuantity != null">
				#{bookQuantity,jdbcType=INTEGER},
			</if>
			<if test="warnStock != null">
				#{warnStock,jdbcType=INTEGER},
			</if>
			<if test="goodsUnit != null">
				#{goodsUnit,jdbcType=CHAR},
			</if>
			<if test="isSale != null">
				#{isSale,jdbcType=TINYINT},
			</if>
			<if test="isBest != null">
				#{isBest,jdbcType=TINYINT},
			</if>
			<if test="isHot != null">
				#{isHot,jdbcType=TINYINT},
			</if>
			<if test="isRecomm != null">
				#{isRecomm,jdbcType=TINYINT},
			</if>
			<if test="isNew != null">
				#{isNew,jdbcType=TINYINT},
			</if>
			<if test="isAdminBest != null">
				#{isAdminBest,jdbcType=TINYINT},
			</if>
			<if test="isAdminRecom != null">
				#{isAdminRecom,jdbcType=TINYINT},
			</if>
			<if test="recommDesc != null">
				#{recommDesc,jdbcType=VARCHAR},
			</if>
			<if test="cid1 != null">
				#{cid1,jdbcType=INTEGER},
			</if>
			<if test="cid2 != null">
				#{cid2,jdbcType=INTEGER},
			</if>
			<if test="cid3 != null">
				#{cid3,jdbcType=INTEGER},
			</if>
			<if test="shopCatId1 != null">
				#{shopCatId1,jdbcType=INTEGER},
			</if>
			<if test="shopCatId2 != null">
				#{shopCatId2,jdbcType=INTEGER},
			</if>
			<if test="goodsDesc != null">
				#{goodsDesc,jdbcType=VARCHAR},
			</if>
			<if test="isShopRecomm != null">
				#{isShopRecomm,jdbcType=TINYINT},
			</if>
			<if test="isIndexRecomm != null">
				#{isIndexRecomm,jdbcType=TINYINT},
			</if>
			<if test="isActivityRecomm != null">
				#{isActivityRecomm,jdbcType=TINYINT},
			</if>
			<if test="isInnerRecomm != null">
				#{isInnerRecomm,jdbcType=TINYINT},
			</if>
			<if test="status != null">
				#{status,jdbcType=TINYINT},
			</if>
			<if test="saleTime != null">
				#{saleTime,jdbcType=TIMESTAMP},
			</if>
			<if test="attrCatId != null">
				#{attrCatId,jdbcType=INTEGER},
			</if>
			<if test="goodsKeywords != null">
				#{goodsKeywords,jdbcType=VARCHAR},
			</if>
			<if test="goodsFlag != null">
				#{goodsFlag,jdbcType=TINYINT},
			</if>
			<if test="statusRemarks != null">
				#{statusRemarks,jdbcType=VARCHAR},
			</if>
			<if test="createTime != null">
				#{createTime,jdbcType=TIMESTAMP},
			</if>
		</trim>
	</insert>

	<update id="updateByPrimaryKeySelective" parameterType="com.dce.business.entity.goods.CTGoodsDo">
		update ct_goods
		<set>
			<if test="goodsSn != null">
				goodsSn = #{goodsSn},
			</if>
			<if test="goodsUnit != null">
				goodsUnit = #{goodsUnit},
			</if>
			<if test="title != null">
				title = #{title},
			</if>
			<if test="goodsImg != null">
				goodsImg = #{goodsImg},
			</if>
			<if test="status != null">
				status = #{status},
			</if>
			<if test="goodsThums != null">
				goodsThums = #{goodsThums},
			</if>
			<if test="brandId != null">
				brandId = #{brandId},
			</if>
			<if test="shopId != null">
				shopId = #{shopId},
			</if>
			<if test="marketPrice != null">
				marketPrice = #{marketPrice},
			</if>
			<if test="shopPrice != null">
				shopPrice = #{shopPrice},
			</if>
			<if test="goodsStock != null">
				goodsStock = #{goodsStock},
			</if>
			<if test="saleCount != null">
				saleCount = #{saleCount},
			</if>
			<if test="saleTime != null">
				saleTime = #{saleTime},
			</if>
			<if test="isBook != null">
				isBook = #{isBook},
			</if>
			<if test="bookQuantity != null">
				bookQuantity = #{bookQuantity},
			</if>
			<if test="warnStock != null">
				warnStock = #{warnStock},
			</if>
			<if test="goodsDesc != null">
				goodsDesc = #{goodsDesc},
			</if>
			<if test="statusRemarks != null">
				statusRemarks = #{statusRemarks},
			</if>
		</set>
		where goodsId = #{goodsId}
	</update>


	<update id="updateBookQty" parameterType="com.dce.business.entity.goods.CTGoodsDo">
		update ct_goods
		<set>

			<if test="bookQuantity != null">
				goodsStock = goodsStock - #{bookQuantity},
			</if>
			<if test="bookQuantity != null">
				saleCount = saleCount + #{bookQuantity},
			</if>

		</set>
		<![CDATA[
		where goodsId = #{goodsId} and goodsStock - #{bookQuantity} >=0
		]]>
	</update>


	<!-- 自定义查询 -->
	<select id="selectByPage4App" parameterType="java.util.Map"
		resultMap="BaseResultMap">
		select goodsId,
		title,
		goodsDesc,
		saleTime,
		shopPrice,
		status,
		createTime,
		goodsimg
		from ct_goods where status=1 and statusRemarks=1 limit #{offset},#{rows}

	</select>


	<select id="queryListPage" parameterType="Map" resultMap="BaseResultMap">
		SELECT *
		FROM ct_goods
		<trim prefix="WHERE" prefixOverrides="AND |OR ">
			<if test="goodsId != null">
				AND goodsId = #{goodsId}
			</if>
			<if test="goodsSn != null">
				AND goodsSn = #{goodsSn}
			</if>
			<if test="title != null">
				AND title = #{title}
			</if>
			<if test="goodsImg != null">
				AND goodsImg = #{goodsImg}
			</if>
			<if test="goodsThums != null">
				AND goodsThums = #{goodsThums}
			</if>
			<if test="brandId != null">
				AND brandId = #{brandId}
			</if>
			<if test="shopId != null">
				AND shopId = #{shopId}
			</if>
			<if test="marketPrice != null">
				AND marketPrice = #{marketPrice}
			</if>
			<if test="shopPrice != null">
				AND shopPrice = #{shopPrice}
			</if>
			<if test="goodsStock != null">
				AND goodsStock = #{goodsStock}
			</if>
			<if test="saleCount != null">
				AND saleCount = #{saleCount}
			</if>
			<if test="isBook != null">
				AND isBook = #{isBook}
			</if>
			<if test="bookQuantity != null">
				AND bookQuantity = #{bookQuantity}
			</if>
			<if test="warnStock != null">
				AND warnStock = #{warnStock}
			</if>
			<if test="goodsUnit != null">
				AND goodsUnit = #{goodsUnit}
			</if>
			<if test="goodsSpec != null">
				AND goodsSpec = #{goodsSpec}
			</if>
			<if test="isSale != null">
				AND isSale = #{isSale}
			</if>
			<if test="isBest != null">
				AND isBest = #{isBest}
			</if>
			<if test="isHot != null">
				AND isHot = #{isHot}
			</if>
			<if test="isRecomm != null">
				AND isRecomm = #{isRecomm}
			</if>
			<if test="isNew != null">
				AND isNew = #{isNew}
			</if>
			<if test="isAdminBest != null">
				AND isAdminBest = #{isAdminBest}
			</if>
			<if test="isAdminRecom != null">
				AND isAdminRecom = #{isAdminRecom}
			</if>
			<if test="recommDesc != null">
				AND recommDesc = #{recommDesc}
			</if>
			<if test="cid1 != null">
				AND cid1 = #{cid1}
			</if>
			<if test="cid2 != null">
				AND cid2 = #{cid2}
			</if>
			<if test="cid3 != null">
				AND cid3 = #{cid3}
			</if>
			<if test="shopCatId1 != null">
				AND shopCatId1 = #{shopCatId1}
			</if>
			<if test="shopCatId2 != null">
				AND shopCatId2 = #{shopCatId2}
			</if>
			<if test="goodsDesc != null">
				AND goodsDesc = #{goodsDesc}
			</if>
			<if test="isShopRecomm != null">
				AND isShopRecomm = #{isShopRecomm}
			</if>
			<if test="isIndexRecomm != null">
				AND isIndexRecomm = #{isIndexRecomm}
			</if>
			<if test="isActivityRecomm != null">
				AND isActivityRecomm = #{isActivityRecomm}
			</if>
			<if test="isInnerRecomm != null">
				AND isInnerRecomm = #{isInnerRecomm}
			</if>
			<if test="status != null">
				AND status = #{status}
			</if>
			<if test="saleTime != null">
				AND saleTime = #{saleTime}
			</if>
			<if test="attrCatId != null">
				AND attrCatId = #{attrCatId}
			</if>
			<if test="goodsKeywords != null">
				AND goodsKeywords = #{goodsKeywords}
			</if>
			<if test="goodsFlag != null">
				AND goodsFlag = #{goodsFlag}
			</if>
			<if test="statusRemarks != null">
				AND statusRemarks = #{statusRemarks}
			</if>
			<if test="createTime != null">
				AND createTime = #{createTime}
			</if>
			<if test="startDate != null">
				AND <![CDATA[createTime >= STR_TO_DATE(#{startDate},'%Y-%m-%d %H:%i:%s')]]>
			</if>
			<if test="endDate != null">
				AND <![CDATA[createTime <= STR_TO_DATE(#{endDate},'%Y-%m-%d %H:%i:%s')]]>
			</if>
		</trim>
		order by saleTime desc
	</select>

</mapper>